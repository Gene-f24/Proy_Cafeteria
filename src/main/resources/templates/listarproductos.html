<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<title>Getting Started: Serving Web Content</title>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css">
</head>

<body>
	<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
		<a class="navbar-brand" href="#">Cafetería</a>
		<div class="collapse navbar-collapse">
			<ul class="navbar-nav mr-auto">
				<li class="nav-item"><a class="nav-link"
						th:href="${session.usuarioLogueado.idtipousua == 1} ? @{/admin/home} : @{/vend/home}">Inicio</a>
				</li>
				<li class="nav-item"><a class="nav-link" th:href="@{/clientes/cargarclientes}">Clientes</a></li>
				<li class="nav-item"><a class="nav-link" th:href="@{/productos/cargarproductos}">Productos</a></li>
				<li class="nav-item"><a class="nav-link" th:href="@{/ventas/cargarventas}">Ventas</a></li>
				<li class="nav-item"
					th:if="${session.usuarioLogueado != null and session.usuarioLogueado.idtipousua == 1}">
					<a class="nav-link" th:href="@{/usuarios/cargarusuarios}">Usuarios</a>
				</li>
			</ul>
		</div>
	</nav>
	<div class="container mt-2">
		<h4>Lista de Productos</h4><br>
		<div class="mb-3">
			<a th:href="@{/productos/nuevo}" class="btn btn-primary">Agregar nuevo producto</a>
			<a th:href="${session.usuarioLogueado.idtipousua == 1} ? @{/admin/home} : @{/vend/home}"
				class="btn btn-secondary">Volver</a>
		</div>

		<form th:action="@{/productos/buscar}" method="get" class="form-inline mb-4">
			<div class="d-flex flex-wrap gap-2">
				<input type="text" name="txtProducto" class="form-control" style="width: 280px;"
					placeholder="Buscar por nombre o categoria" required>
				<button type="submit" class="btn btn-success">Buscar</button>
				<a th:href="@{/productos/cargarproductos}" class="btn btn-secondary ml-2">Mostrar todos</a>
			</div>
		</form>
		<div class="row">
			<div class="col-6 col-sm-7">
				<h3></h3>
				<table class="table">
					<thead>
						<tr>
							<th>Id</th>
							<th></th>
							<th>Producto</th>
							<th>Precio</th>
							<th>Stock</th>
							<th>Categoria</th>
							<th>Opcion</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="p : ${lstProductos}">
							<th scope="row" th:text="${p.id_prod}">1</th>
							<th scope="row">
								<img th:src="@{/img/productos/} +${p.id_prod} + @{.png}" width="80px" height="80px"
									class="rounded-circle" alt="imagen del producto">
							</th>
							<td th:text="${p.desProd}">xx</td>
							<td th:text="${'S/'} + 
							${#numbers.formatDecimal(p.pre_prod,1,'COMMA',2,'POINT')}">xx</td>
							<td th:text="${p.stk_prod}">xx</td>
							<td th:text="${p.objCat.desCateg}">xx</td>
							<td class="d-flex justify-content-center">
								<a th:href="@{/productos/editar/}+${p.id_prod}" class="btn btn-warning btn-sm mr-1">
									Editar</a>
								<a th:href="@{/productos/eliminar/}+${p.id_prod}" class="btn btn-danger btn-sm"
									onclick="return confirm('¿Seguro que deseas eliminar este producto?');">
									Eliminar</a>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<p th:text="${mensaje}" class="text-danger"></p>
	</div>
</body>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"></script>

</html>